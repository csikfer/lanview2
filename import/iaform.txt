
SET REPLACE;

TABLE view_alarms SHAPE uaalarms  "Nem nyugtázott riasztások" {
    SET DEFAULTS;               // Az összes mező felvétele alapértelmezett tulajdonságokkal
    TABLE TYPE BARE;
    TABLE TITLE "Nem nyugtázott riasztások";
    // Nincs nyugtázva, és zónán bellül
    REFINE "ack_user_name IS NULL AND is_group_place(place_id, ?) AND user_is_any_groups_member(?, online_group_ids):place_group_id:user_id";
    TABLE VIEW   RIGHTS indalarm;
    TABLE EDIT   RIGHTS system;
    TABLE INSERT RIGHTS system;
    TABLE DELETE RIGHTS admin;
    FIELD view_alarm_id, host_service_id, node_id, place_id, superior_alarm_id, ack_user_name, max_status, ack_msg,
        online_group_ids, offline_group_ids FLAG HIDE;
    FIELD begin_time TITLE "Kezdete";
    FIELD end_time   TITLE "Vége";
    FIELD node_name  TITLE "Eszköz";
    FIELD place_name TITLE "Helye";
    FIELD msg        TITLE "Leírás";
    FIELD msg        FLAG ON HUGE;
    FIELD SEQUENCE begin_time, end_time, place_name, node_name, msg;
    AUTO REFRESH "0:0:30";
}

TABLE view_alarms SHAPE aaalarms "Nyugtázott aktív riasztások" {
    SET DEFAULTS;               // Az összes mező felvétele alapértelmezett tulajdonságokkal
    TABLE TYPE BARE;
    TABLE TITLE "Nyugtázott és aktív riasztások";
    // Nyugtázva, de még fennál a riasztási állpot, és zónán bellül
    REFINE "ack_user_name IS NOT NULL AND end_time IS NULL AND is_group_place(place_id, ?) AND user_is_any_groups_member(?, online_group_ids):place_group_id:user_id";
    TABLE VIEW   RIGHTS indalarm;
    TABLE EDIT   RIGHTS system;
    TABLE INSERT RIGHTS system;
    TABLE DELETE RIGHTS admin;
    FIELD view_alarm_id, host_service_id, node_id, place_id, superior_alarm_id, max_status, end_time,
        online_group_ids, offline_group_ids FLAG HIDE;
    FIELD begin_time TITLE "Kezdete";
    FIELD ack_user_name TITLE "Nyugtázta";
    FIELD node_name  TITLE "Eszköz";
    FIELD place_name TITLE "Helye";
    FIELD msg        TITLE "Leírás";
    FIELD ack_msg    TITLE "Nyugtázó üzenete";
    FIELD msg, ack_msg FLAG ON HUGE;
    FIELD SEQUENCE begin_time, place_name, node_name, msg, ack_msg;
    AUTO REFRESH "0:0:30";
}
